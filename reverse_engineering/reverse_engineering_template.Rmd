---
title: "Reverse Engineering Project"
author: "Alex Taylor, Jordan Fine, Devin Etta"
date: "Date here"
output:
  html_document:
    theme: cerulean
    highlight: pygments
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction 

In this notebook, we are reverse engineering the story, Inside The Political Donation History Of Wealthy Sports Owners(https://fivethirtyeight.com/features/inside-the-political-donation-history-of-wealthy-sports-owners/)

## Load libraries

Loading required libraries for this analysis.

```{r echo=FALSE, message=FALSE}
library(tidyverse)
library(janitor)
library(lubridate)

```

## Load and Cleaning Data

In this section, describe the source of the data, write a basic data dictionary for data you are working with, and discuss any caveats or issues you discovered working with this data.

This data was obtained from campaign finance reports from the Federal Elections Commission. It contains every instance of an NBA, NFL, NHL, WNBA, MLB and NASCAR owner or commissioner donating to a political campaign in the 2016, 2018 and 2020 election cycles. It also contains the amount of the donations, the recipient and what party the recipient belongs to. One annoying part of the data is that the "Amount" column is a character data type and not a numeric data type, which means we can not do math with it without converting it to a numeric. 

```{r}
# Load required data
Donations <- read_csv("data/sports-political-donations.csv")



# Clean required data and prepare for analysis if needed. 
sports_donations <- read_csv("data/sports-political-donations.csv")
sports_donations <- sports_donations |>
  clean_names()
sports_donations <- sports_donations %>%
  mutate(amount = as.numeric(gsub("[$,]", "", amount)))


```


## Sentences to Engineer
In this notebook, we are reverse engineering five sentences from the story.

### Sentence 1 - Jordan

* **Sentence text**: “American professional sports owners have contributed nearly $47 million in federal elections since 2015… $34.2 million (72.9 percent) [went] to Republican campaigns or super PACs… compared to $10.1 million (21.5 percent) to Democrats.”

* **Analysis summary**: I think this quote includes an interesting statistic that provides the main point of the article. There is a big difference in how much money went to republicans vs democrats, this could mean something important or make for an important story. 


```{r}
# Split dataset by party
republican_donors <- sports_donations |> filter(party == "Republican")
democrat_donors   <- sports_donations |> filter(party == "Democrat")

# Calculate totals, averages, and counts for each party
party_summary <- sports_donations |>
  group_by(party) |>
  summarize(
    total_donated = sum(amount, na.rm = TRUE),
    average_donation = mean(amount, na.rm = TRUE),
    number_of_donors = n()
  )

# Calculate percentages of total donations
total_all <- sum(party_summary$total_donated)
party_summary <- party_summary |>
  mutate(percent_of_total = (total_donated / total_all) * 100)

# Arrange from highest to lowest total donated
party_summary <- party_summary |> arrange(desc(total_donated))

party_summary


```

### Sentence 2 - Alex

* **Sentence text**: Overall, 51.7 percent of all contributions by WNBA owners went to Democrats, with 42.3 percent going to Republicans.

* **Analysis summary**:I was able to confirm that 51.7% of the donations by WNBA owners went to Democrats and that 42.3% of WNBA donations went to Republicans. One important thing to note that I discovered during my analysis is that, when the article says "all contributions" it means the total amount of money donated as opposed to the quantity of donations. 



```{r}
# Put code to reverse engineer sentence here

# Turn the amount column into a numeric type, instead of a character
Donations_AmountClean <- Donations |>
  mutate(Amount = str_replace_all(Amount, "\\$", ""),
         Amount = str_replace_all(Amount, "\\,", ""),
         Amount = as.numeric(Amount)
         )

# Filter to only focus on WNBA players, then see how many contributions were made to each party

WNBA_Contribs <- Donations_AmountClean |>
  filter(str_detect(League,"WNBA"))|>
  group_by(Party) |>
  summarise(numb_contrib = sum(Amount))

# Find the percentage of contributions each party got
WNBA_Contribs <- WNBA_Contribs |>
  mutate(
    pct_contrib = numb_contrib / sum(numb_contrib) * 100
  )

# Display results of code below this codeblock
WNBA_Contribs


```

### Sentence 3 - * Devin: Thirteen owners have contributed directly to Trump’s campaign or Trump super PACs in the 2020 election cycle, with contributions adding up to $1,746,423… By contrast, 20 owners have contributed directly to Biden or Biden’s super PACs, though at smaller totals, with overall contributions equaling $405,745.

* **Analysis summary**: I found that there is actually 12 owner/ owner groups that donated to Trump's campaign or his Super PACS for the 2020 campaign, maybe there is a hidden recipent name that was for Trump that I didn't consider. The contributions add up to $1,544,421. 

As for Biden's 2020 campaign, there is a 20 owners for  as the total $228545 (21 rows but duplicate of an owner)

```{r}
# Put code to reverse engineer sentence here
#shrump says 

#This is to see the amount of owners(through the rows)
 
TrumpTotal2020 <- sports_donations |> 
  filter(str_detect(recipient, "TRUMP VICTORY") |
         str_detect(recipient, "Trump Victory") |
         str_detect(recipient, "TRUMP MAKE AMERICA GREAT AGAIN COMMITTEE")|
         str_detect(recipient, "DONALD J. TRUMP FOR PRESIDENT, INC.")|
         str_detect(recipient, "Trump Make America Great Again Committee")) 

TrumpTotal2020 <- TrumpTotal2020 |>
  filter(election_year == 2020)

  #Code to see total amount for trump 2020 
TrumpTotal2020 |> 
  summarize(total_amount = sum(amount))

TrumpTotal2020

#joever 

#look at rows for the amount of donors
BidenTotal2020 <- sports_donations |> 
  filter(str_detect(recipient, "BIDEN FOR PRESIDENT") |
         str_detect(recipient, "BIDEN ACTION FUND") |
         str_detect(recipient, "BIDEN VICTORY FUND") |
         str_detect(recipient, "Biden For President") |
         str_detect(recipient, "Biden Action Fund") |
         str_detect(recipient, "Biden Victory Fund") |
         str_detect(recipient, "Biden for President")
         ) 


BidenTotal2020 |> summarize(total_amount = sum(amount))
# Display results of code below this codeblock

BidenTotal2020
```


### Sentence 4 - Alex

* **Sentence text**: Of the 160 owners and commissioners in ESPN’s database, 74 contributed a majority of their publicly searchable funds to Republican campaigns, with 48 donating a majority to Democrats and the rest sending most of their money to causes that aren’t fully aligned with either party.

* **Analysis summary**: I was able to confirm that 48 owners donated the majority of their funds to Democrats, however, I was not able to confirm that 74 owners contributed the majority of their funds to Republican campaigns. I tried factoring in donations that were bipartisan, but leaned a certain way, but that did not change the total. I think the four owner difference could be, in part, because the number of owners in the dataset we have is 158, while the article stated that it's database has 160 owners in it. 


```{r}
# Put code to reverse engineer sentence here


# Group donations that lean towards a particular party with that party

Owners_PartyDons <- Donations_AmountClean |>
  mutate(
    Party2 = case_when(
      Party == "Bipartisan, but mostly Republican" ~ "Republican",
      Party == "Bipartisan, but mostly Democratic" ~ "Democrat",
      TRUE ~ Party
    )
  )

# Filter out unused categories
Owners_PartyDons <- Owners_PartyDons |>
  filter(Party2 != "Independent" |
          Party2 != "N/A " |
          Party2 != "Bipartisan"
           )


# Create a dataframe that lists the owners, which party they donated to, and how much they donated to that party
Owners_PartyDons <- Owners_PartyDons |>
  group_by(Owner, Party2) |>
  summarise(Contrib = sum(Amount))

# Add a column with the total amount each owner donated

      # Create a dataframe with the total amount each owner donated
      Owner_Total <- Donations_AmountClean |>
        group_by(Owner) |>
        summarise(Owner_Total = sum(Amount))

      # Join that dataframe to the first dataframe (that has the list of owners and party donations)
      Owners_PartyDons <- Owners_PartyDons |>
        left_join(Owner_Total)

# Create a column listing what percent each owner donated to each party

Owners_PartyDons <- Owners_PartyDons |>
  mutate(
    Pct_Don = (Contrib / Owner_Total) * 100
  )


# Find out how many owners contributed the majority of their funds to Republican campaigns

Majority_Rep <- Owners_PartyDons |>
  filter(Party2 == "Republican" & Pct_Don > 50)



# Find out how many owners contributed the majority of their funds to Democratic campaigns

Majority_Dem <- Owners_PartyDons |>
  filter(Party2 == "Democrat" & Pct_Don > 50)

# Display results of code below this codeblock

nrow(Majority_Rep)
nrow(Majority_Dem)


```


### Sentence 5 - Jordan

* **Sentence text**: “Forty owners account for more than $40 million — more than 85 percent of all contributions. And looking specifically at these big spenders, it’s clear where their allegiances lie: 77.7 percent of that $40 million went to Republican causes or candidates, with 18.8 percent going to Democrats.” 

* **Analysis summary**:This paragraph displays a statistic that slices the data and looks at the top donors. The github data from the article helps to list the owners and their sport teams that have a concentrated spending power. Either the data can be grouped by donations, or just the owners. The numbers generated by the r code don’t exactly match the story which could mean inaccurate or uncleaned data. This could also signify that the n/a values actually went to the republican party, but aren’t labeled on r. 




```{r}
owner_totals <- sports_donations |> 
  group_by(owner) |> 
  summarize(total_donated = sum(amount, na.rm = TRUE)) |> 
  arrange(desc(total_donated))

top40_owners <- owner_totals |> 
  slice_max(order_by = total_donated, n = 40)

sports_donations |> 
  semi_join(top40_owners, by = "owner") |>
  group_by(party) |>
  summarize(
    total_donated = sum(amount, na.rm = TRUE)
  ) |>
  mutate(
    percent = total_donated / sum(total_donated) * 100
  )

```
-30-
